C:\Anaconda3_4.2.0_64bit\python.exe C:/deep_learning_test/rnn/LSTM_PM25_Data.py
Using TensorFlow backend.
                     pollution  dew  temp   press wnd_dir  wnd_spd  snow  rain
date
2010-01-02 00:00:00      129.0  -16  -4.0  1020.0      SE     1.79     0     0
2010-01-02 01:00:00      148.0  -15  -4.0  1020.0      SE     2.68     0     0
2010-01-02 02:00:00      159.0  -11  -5.0  1021.0      SE     3.57     0     0
2010-01-02 03:00:00      181.0   -7  -5.0  1022.0      SE     5.36     1     0
2010-01-02 04:00:00      138.0   -7  -5.0  1022.0      SE     6.25     2     0
   var1(t-3)  var2(t-3)  var3(t-3)  var4(t-3)  var5(t-3)  var6(t-3)  \
3   0.129779   0.352941   0.245902   0.527273   0.666667   0.002290
4   0.148893   0.367647   0.245902   0.527273   0.666667   0.003811
5   0.159960   0.426471   0.229508   0.545454   0.666667   0.005332
6   0.182093   0.485294   0.229508   0.563637   0.666667   0.008391
7   0.138833   0.485294   0.229508   0.563637   0.666667   0.009912

   var7(t-3)  var8(t-3)  var1(t-2)  var1(t-1)   ...     var7(t-1)  var8(t-1)  \
3   0.000000        0.0   0.148893   0.159960   ...      0.000000        0.0
4   0.000000        0.0   0.159960   0.182093   ...      0.037037        0.0
5   0.000000        0.0   0.182093   0.138833   ...      0.074074        0.0
6   0.037037        0.0   0.138833   0.109658   ...      0.111111        0.0
7   0.074074        0.0   0.109658   0.105634   ...      0.148148        0.0

    var1(t)   var2(t)   var3(t)   var4(t)   var5(t)   var6(t)   var7(t)  \
3  0.182093  0.485294  0.229508  0.563637  0.666667  0.008391  0.037037
4  0.138833  0.485294  0.229508  0.563637  0.666667  0.009912  0.074074
5  0.109658  0.485294  0.213115  0.563637  0.666667  0.011433  0.111111
6  0.105634  0.485294  0.213115  0.581818  0.666667  0.014492  0.148148
7  0.124748  0.485294  0.229508  0.600000  0.666667  0.017551  0.000000

   var8(t)
3      0.0
4      0.0
5      0.0
6      0.0
7      0.0

[5 rows x 25 columns]
(8760, 24) 8760 (8760,)
(8760, 3, 8) (8760,) (35037, 3, 8) (35037,)
Train on 8760 samples, validate on 35037 samples
Epoch 1/50
2018-05-03 15:00:20.348764: W C:\tf_jenkins\home\workspace\rel-win\M\windows-gpu\PY\35\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2018-05-03 15:00:20.348997: W C:\tf_jenkins\home\workspace\rel-win\M\windows-gpu\PY\35\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2018-05-03 15:00:20.546288: I C:\tf_jenkins\home\workspace\rel-win\M\windows-gpu\PY\35\tensorflow\core\common_runtime\gpu\gpu_device.cc:955] Found device 0 with properties:
name: GeForce GTX 1080
major: 6 minor: 1 memoryClockRate (GHz) 1.7335
pciBusID 0000:01:00.0
Total memory: 8.00GiB
Free memory: 6.66GiB
2018-05-03 15:00:20.546562: I C:\tf_jenkins\home\workspace\rel-win\M\windows-gpu\PY\35\tensorflow\core\common_runtime\gpu\gpu_device.cc:976] DMA: 0
2018-05-03 15:00:20.546681: I C:\tf_jenkins\home\workspace\rel-win\M\windows-gpu\PY\35\tensorflow\core\common_runtime\gpu\gpu_device.cc:986] 0:   Y
2018-05-03 15:00:20.546824: I C:\tf_jenkins\home\workspace\rel-win\M\windows-gpu\PY\35\tensorflow\core\common_runtime\gpu\gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080, pci bus id: 0000:01:00.0)
2s - loss: 0.0434 - val_loss: 0.0636
Epoch 2/50
1s - loss: 0.0228 - val_loss: 0.0429
Epoch 3/50
1s - loss: 0.0193 - val_loss: 0.0349
Epoch 4/50
1s - loss: 0.0179 - val_loss: 0.0258
Epoch 5/50
1s - loss: 0.0164 - val_loss: 0.0196
Epoch 6/50
1s - loss: 0.0141 - val_loss: 0.0159
Epoch 7/50
1s - loss: 0.0119 - val_loss: 0.0119
Epoch 8/50
1s - loss: 0.0109 - val_loss: 0.0092
Epoch 9/50
1s - loss: 0.0093 - val_loss: 0.0078
Epoch 10/50
1s - loss: 0.0079 - val_loss: 0.0083
Epoch 11/50
1s - loss: 0.0064 - val_loss: 0.0093
Epoch 12/50
1s - loss: 0.0060 - val_loss: 0.0075
Epoch 13/50
1s - loss: 0.0046 - val_loss: 0.0058
Epoch 14/50
1s - loss: 0.0060 - val_loss: 0.0034
Epoch 15/50
1s - loss: 0.0036 - val_loss: 0.0034
Epoch 16/50
1s - loss: 0.0036 - val_loss: 0.0043
Epoch 17/50
1s - loss: 0.0040 - val_loss: 0.0102
Epoch 18/50
1s - loss: 0.0034 - val_loss: 0.0113
Epoch 19/50
1s - loss: 0.0028 - val_loss: 0.0024
Epoch 20/50
1s - loss: 0.0020 - val_loss: 0.0023
Epoch 21/50
1s - loss: 0.0029 - val_loss: 0.0050
Epoch 22/50
1s - loss: 0.0026 - val_loss: 0.0034
Epoch 23/50
1s - loss: 0.0023 - val_loss: 0.0035
Epoch 24/50
1s - loss: 0.0033 - val_loss: 0.0058
Epoch 25/50
1s - loss: 0.0028 - val_loss: 0.0027
Epoch 26/50
1s - loss: 0.0020 - val_loss: 0.0032
Epoch 27/50
1s - loss: 0.0027 - val_loss: 0.0024
Epoch 28/50
1s - loss: 0.0026 - val_loss: 0.0051
Epoch 29/50
1s - loss: 0.0032 - val_loss: 0.0048
Epoch 30/50
1s - loss: 0.0021 - val_loss: 0.0023
Epoch 31/50
1s - loss: 0.0026 - val_loss: 0.0045
Epoch 32/50
1s - loss: 0.0032 - val_loss: 0.0015
Epoch 33/50
1s - loss: 0.0021 - val_loss: 0.0028
Epoch 34/50
1s - loss: 0.0028 - val_loss: 0.0035
Epoch 35/50
1s - loss: 0.0021 - val_loss: 0.0013
Epoch 36/50
1s - loss: 0.0019 - val_loss: 0.0024
Epoch 37/50
1s - loss: 0.0030 - val_loss: 0.0089
Epoch 38/50
1s - loss: 0.0023 - val_loss: 0.0044
Epoch 39/50
1s - loss: 0.0023 - val_loss: 0.0018
Epoch 40/50
1s - loss: 0.0023 - val_loss: 0.0022
Epoch 41/50
1s - loss: 0.0024 - val_loss: 0.0031
Epoch 42/50
1s - loss: 0.0017 - val_loss: 0.0040
Epoch 43/50
1s - loss: 0.0023 - val_loss: 0.0093
Epoch 44/50
1s - loss: 0.0018 - val_loss: 0.0044
Epoch 45/50
1s - loss: 0.0018 - val_loss: 0.0028
Epoch 46/50
1s - loss: 0.0021 - val_loss: 0.0014
Epoch 47/50
1s - loss: 0.0017 - val_loss: 0.0052
Epoch 48/50
1s - loss: 0.0017 - val_loss: 0.0032
Epoch 49/50
1s - loss: 0.0023 - val_loss: 0.0039
Epoch 50/50
1s - loss: 0.0019 - val_loss: 0.0011
[0.04343968244550163, 0.022813020883868003, 0.019294905806700253, 0.01785753494613383, 0.01639614953493623, 0.01414107444236846, 0.011923087028505867, 0.010947343786183285, 0.009293539035899488, 0.007879297435921553, 0.006416490028790926, 0.0059883401952428765, 0.004641985227927974, 0.005991410705490574, 0.003603070009857008, 0.0036068741992843173, 0.003984727584501754, 0.0034033636634289094, 0.00284357123867902, 0.0019533994098908385, 0.0028845499366942843, 0.0026489065216905245, 0.0023305148605499673, 0.0033448995193083807, 0.0027996415073013774, 0.0020072189467474307, 0.0027152696222526164, 0.0026455536014272844, 0.003190504132183141, 0.002145620540250093, 0.0026006744649860855, 0.003172288927224095, 0.002053668814207338, 0.0028442088098341776, 0.0020897911043442174, 0.001891924469087477, 0.0030121170480301835, 0.002293181589769506, 0.0022962265572995457, 0.002259806619178861, 0.00239949698020921, 0.001722880195162884, 0.002269636276768112, 0.0017967471209424867, 0.0018103670796908897, 0.0021260343602067496, 0.0017005319797995257, 0.0017032705687547792, 0.0022833097022033158, 0.0018859138264167696]
[0.06359654994125985, 0.04285817222098918, 0.034944720784929, 0.0258356932906643, 0.01956204397495259, 0.015929851143444116, 0.011878461471019322, 0.009205083662752639, 0.0077653891617954236, 0.008317929099156263, 0.009338422730323927, 0.007535239136994321, 0.0058335104195036, 0.0034034467696274673, 0.003363619710244822, 0.004253923834243877, 0.01019287802914869, 0.011319953258798357, 0.0023962000855372685, 0.0023196594292743404, 0.004962496142564095, 0.0034345191926856886, 0.0035043669045292034, 0.00581372255601052, 0.002656812224830909, 0.0032435340881960084, 0.0024318159176307044, 0.005096671604133919, 0.004825548592054412, 0.002295589696071925, 0.004472176999413721, 0.0015149908494661213, 0.00284291147879994, 0.0034730389968781797, 0.001302300505687581, 0.0023771919200764793, 0.008854193555517947, 0.004361026822174274, 0.0017640473960542124, 0.002247047042708596, 0.003127110593881905, 0.004032287300115075, 0.009337146313382073, 0.004397815375569935, 0.0028015121905147003, 0.0013665785927362807, 0.0052360568320339905, 0.00322457727920642, 0.0038552775713735932, 0.0011475403894410264]
Test RMSE: 1.592

Process finished with exit code 0
